<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swift Transport Booking</title>
    <style>
        /* (Your existing styles go here) */
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&libraries=places"></script>
</head>
<body>
    <h1>Book Your Ride</h1>
    <form id="bookingForm">
        <!-- Your input fields go here (Name, Phone, Pickup, Dropoff, etc.) -->

        <button type="submit" id="confirmInfoBtn">Confirm Info</button>

        <div id="fareContainer" style="display: none;">
            <!-- Fare Breakdown, Balance, Referral Info, etc. -->
        </div>
    </form>

    <div id="map"></div>

    <script>
        let baseFare = 10.00;
        let totalFare = 0;

        // Google Maps Initialization
        function initMap() {
            // Your existing map code
        }

        // On "Confirm Info" button click
        document.getElementById('confirmInfoBtn').addEventListener('click', async function(event) {
            event.preventDefault();

            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const userID = name + phone.slice(-4);  // Example user ID generation

            // Fetch user data
            const response = await fetch(`YOUR_GOOGLE_SCRIPT_URL?userID=${userID}`);
            const userInfo = await response.json();

            if (userInfo) {
                // Existing user: Display the info
                document.getElementById('referralCode').innerText = userInfo.userID;
                document.getElementById('userTier').innerText = `${userInfo.userTier} (${userInfo.tierDiscount})`;
                document.getElementById('referralCount').innerText = userInfo.referralCount;
                document.getElementById('referralEarnings').innerText = `$${userInfo.referralEarnings}`;
                document.getElementById('ridesEarnings').innerText = `$${userInfo.ridesEarnings}`;
                document.getElementById('totalBalance').innerText = `$${userInfo.totalBalance}`;
            } else {
                // New user: Handle new user creation
                const newUser = {
                    userID, name, phone, rides: 0, totalPaid: 0,
                    ridesEarnings: 0, referralEarnings: 0,
                    balanceExpiry: '', referralCode: userID, referralCount: 0,
                    tipsPaid: 0, userTier: 'Silver', tierDiscount: '0%'
                };

                await fetch('YOUR_GOOGLE_SCRIPT_URL', {
                    method: 'POST',
                    body: JSON.stringify(newUser)
                });
                alert('New user created.');
            }

            // (Handle fare calculation and map updates)
        });

        // Google Maps initialization when the page loads
        window.onload = function() {
            initMap();
        };
    </script>
</body>
</html>
